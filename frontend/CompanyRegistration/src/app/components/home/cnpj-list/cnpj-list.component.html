<div class="cnpj-list-container">
    <h2 class="title">Empresas Vinculadas</h2>

    <div [formGroup]="filterForm" class="controls">
        <label>
            Itens por página:
            <select formControlName="pageSize" (change)="onFiltersChange()">
                <option *ngFor="let size of pageSizes" [value]="size" [disabled]="isLoading">{{ size }}</option>
            </select>
        </label>

        <label>
            Ordenar por:
            <select formControlName="sortBy" (change)="onFiltersChange()">
                <option *ngFor="let field of orderFields" [value]="field.value" [disabled]="isLoading">{{ field.label }}</option>
            </select>
        </label>

        <label>
            Ordem:
            <select formControlName="sortDirection" (change)="onFiltersChange()">
                <option value="asc" [disabled]="isLoading">Ascendente</option>
                <option value="desc" [disabled]="isLoading">Descendente</option>
            </select>
        </label>
    </div>

    <ul class="company-list">
        <div *ngIf="isLoading" class="loading">Carregando...</div>
        <li *ngFor="let company of companies" class="company-card">
            <h3>{{ company.nome || company.fantasia || "N/A" }}</h3>
            <p><strong>CNPJ:</strong> {{ company.cnpj || "N/A" }}</p>
            <p><strong>Abertura:</strong> {{ company.abertura || "N/A" }}</p>
            <p><strong>Atividade:</strong> {{ company.atividadePrincipal || "N/A" }}</p>
            <p><strong>Natureza Jurídica:</strong> {{ company.naturezaJuridica || "N/A" }}</p>
            <p><strong>Localização:</strong> {{ company.municipio || "N/A"  }}/{{ company.uf || "N/A" }}</p>
        </li>
    </ul>

    <div *ngIf="!isLoading" class="pagination">
        <button (click)="goToPage(currentPage - 1)" [disabled]="currentPage === 1">Anterior</button>
        <div class="data-pagination">
            <span>Total de resultados: {{ totalResults }}</span>
            <span>Página {{ currentPage }}</span>
        </div>
        <button (click)="goToPage(currentPage + 1)" [disabled]="currentPage === totalPages">Próxima</button>
    </div>
</div>